# SDR Tools Technical Reference #

This documents serves to outline the tools currently included in the SDR, their purpose and interfaces.

Contents:
  * Teklia Machine Learning tools
    * [Teklia DLA](#teklia-dla "Teklia DLA")
    * [Teklia HTR](#teklia-htr "Teklia HTR")
    * [Teklia NER](#teklia-ner "Teklia NER")
  * Third party image processing tools
    * [Mothra](#mothra "Mothra")
    * [Barcode reader](#barcode-reader "Barcode Reader")
  * Input file processing
    * [Split File](#split-file "Split File")
    * [CSV to OpenDS](#create-sdo-from-csv-csv-to-opends "CSV to OpenDS")
    * [Create OpenDS](#create-opends "Create OpenDS")
  * Output file processing
    * [Save output as ROCrate](#save-output-as-rocrate "Save output as ROCrate")
    * [OpenDS to CSV](#opends-to-csv "OpenDS to CSV")
    * [Save Output](#save-output "Save output")
  * Misc
    * [Validate OpenDS](#validate-opends "Validate OpenDS")
    * [Download Image](#download-image "Download Image")

## Teklia Machine Learning tools ##

### Teklia DLA ###

#### Purpose ####

The Teklia segmentation tool implements allows the identification of regions of interest, identifying alternatively samples or lines of text.

#### Input ####
  * OpenDS specimen object
    * Description: Incrementally built Fair Digital Object collating specimen data and annotations
    * Type: [json]
  * Training model
    * Description: Selection of models for use in the Teklia tools
    * Type: [text] (options: "pinned\_insects", "line\_synthesys")
  
#### Output ####
  * OpenDS specimen object
    * Description: Incrementally built Fair Digital Object collating specimen data and annotations
    * Type: [json]

### Teklia HTR ###

#### Purpose ####

The Teklia Handwritten Text Recognition tool reads handwritten text in identified regions utilising the [Kaldi](https://github.com/kaldi-asr/kaldi "Kaldi") library.

#### Input ####
  * OpenDS specimen object
    * Description: Incrementally built Fair Digital Object collating specimen data and annotations
    * Type: [json]
  * Training model
    * Description: Selection of models for use in the Teklia tools
    * Type: [text] (options: "kaldi\_synthesys")
  
#### Output ####
  * OpenDS specimen object
    * Description: Incrementally built Fair Digital Object collating specimen data and annotations
    * Type: [json]

### Teklia NER ###

#### Purpose ####

The Teklia Named Entity Recognition tool implements the [Spacy](https://spacy.io/ "Spacy") library.

#### Input ####
  * OpenDS specimen object
    * Description: Incrementally built Fair Digital Object collating specimen data and annotations
    * Type: [json]
  * Training model
    * Description: Selection of models for use in the Teklia tools
    * Type: [text] (options: "pinned\_insects")
  
#### Output ####
  * OpenDS specimen object
    * Description: Incrementally built Fair Digital Object collating specimen data and annotations
    * Type: [json]

## Third party image processing tools ##

### Mothra ###

#### Purpose ####

[Mothra](https://github.com/machine-shop/mothra "Mothra"), is a tool for automatically measuring the wingspan of lepidopterans. When provided with an image of a lepidopteran alongside scale bar, it attempts to produce a set of measurements.

#### Input ####
  * Image 
    * Description: The input image on which Mothra should be run
    * Type: [PNG, JPG, JPEG, TIFF, TIF]
  * Detailed plot
    * Description: Flag to determine if Mothra should produce debugging information on output images
    * Type: [bool]
  
#### Output ####
  * Mothra Image
    * Description: The processed image output by Mothra
    * Type: [JPG] (collection)
  * Mothra Report
    * Description: A csv file produced by Mothra detailing the measurements that it made 
    * Type: [csv]

### Barcode reader ###

#### Purpose ####

This tool reads barcodes from specimen images using the [bardecocde](https://www.bardecode.com/en1/ "bar decode") library.

#### Input ####
  * OpenDS specimen object
    * Description: Incrementally built Fair Digital Object collating specimen data and annotations
    * Type: [json]
  * File location
    * Description: Name of the input file
    * Type: [json]
  
#### Output ####
  * OpenDS specimen object
    * Description: Incrementally built Fair Digital Object collating specimen data and annotations
    * Type: [json]

## Input file processing ##

### Split File ###

#### Purpose ####

Splits a file line by line into seperate entries in a collection

#### Input ####
  * Input 
    * Description: The file which is to be split
    * Type: [generic text]
  
#### Output ####
  * Split files
    * Description: The multiple output files generated by the split
    * Type: [generic text] (collection)


### Create SDO from CSV (CSV to OpenDS) ###

#### Purpose ####

Create a specimen data object for de novo digitisation from a SDR CSV file.

#### Input ####
  * Input 
    * Description: The SDR specified CSV file to be used in the digitisation
    * Type: [csv]
  
#### Output ####
  * OpenDS specimen object
    * Description: Incrementally built Fair Digital Object collating specimen data and annotations
    * Type: [json]

### Create OpenDS ###

> **WARNING: DEPRECATED**

#### Purpose ####

Create a specimen data object for de novo digitisation

#### Input ####
  * Input
    * Description: Input image
    * Type: [png]
  
#### Output ####
  * OpenDS specimen object
    * Description: Incrementally built Fair Digital Object collating specimen data and annotations
    * Type: [json]

## Output file processing ##

### Save output as ROCrate ###

#### Purpose ####

Saves the output of a digitisation to disk as an RO Crate

#### Input ####
  * Bundle Type
    * Description: Selector to specify if wishing to bundle individual datasets or a collection
      * Type: [select] (options: "Individual dataset", "List Collection")
  * **if** Individual dataset, Single Files
    * Description: Specify one or more files for bundling
    * Type: [data]
  * **if** List Collection, Data Collection
    * Description: Specify a collection for bundling
    * Type: [data] (collection)
  
#### Output ####
  * ROCrate 
    * Description: A Research Object Crate containing the input datasets / collections
    * Type: [zip]

### OpenDS to CSV ###

#### Purpose ####

Create a flat csv from a specimen data object

#### Input ####
  * OpenDS specimen object
    * Description: Incrementally built Fair Digital Object collating specimen data and annotations
    * Type: [json]
  
#### Output ####
  * Input 
    * Description: A flattened representation of the OpenDS object
    * Type: [csv]

### Save Output ###

#### Purpose ####

Saves the output of a digitisation to (the server's) disk

#### Input ####
  * OpenDS specimen object
    * Description: Incrementally built Fair Digital Object collating specimen data and annotations
    * Type: [json]
  * Batch ID
    * Description: A user supplied identifier, under which to save the output
    * Type: [text]
  
#### Output ####
  * OpenDS specimen object
    * Description: Incrementally built Fair Digital Object collating specimen data and annotations
    * Type: [json]

## Misc ##

### Validate OpenDS ###

> **WARNING: DEPRECATED**

#### Purpose ####

A tool to validate a specimen data object.

#### Input ####
  * OpenDS specimen object
    * Description: Incrementally built Fair Digital Object collating specimen data and annotations
    * Type: [json]
  
#### Output ####
  * Validation report
    * Description: Success or failure of validation
    * Type: [text]

### Download Image###

> **WARNING: DEPRECATED**

#### Purpose ####

Download an image to the local filesystem and append file info to opends object.

#### Input ####
  * OpenDS specimen object
    * Description: Incrementally built Fair Digital Object collating specimen data and annotations
    * Type: [json]
  
#### Output ####
  * OpenDS specimen object
    * Description: Incrementally built Fair Digital Object collating specimen data and annotations
    * Type: [json]
